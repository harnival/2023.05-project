<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>호텔 결제</title>
    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- css -->
    <link rel="stylesheet" href="../css/hotel_reset.css">
    <link rel="stylesheet" href="../css/t_hotel_reser02.css">

    <link rel="stylesheet" href="../css/reset.css" />
    <link rel="stylesheet" href="../css/header.css" />
    <link rel="stylesheet" href="../css/footer.css" />
    <script defer src="../js/header.js"></script>
    <script defer src="../js/modal.js"></script>

</head>
<body>
    <header></header>
    <main>
        <div class="loadingWrap">
            <div class="blockWrap">
              <div class="loading_block"></div>
              <div class="loading_block"></div>
              <div class="loading_block"></div>
              <div class="loading_block"></div>
              <div class="loading_block"></div>
            </div>
            <strong>Loading .....</strong>
          </div>
        <div class="mainWrap">
            <div class="title_wrap">
                <div class="title">
                    <div class="title_text_wrap">
                        <h3>예약 확인 및 결제</h3>
                    </div>
                </div>
            </div>
            <div class="btnBox">
                <a href="../t_hotel/t_hotel_reser01.html">객실 예약 페이지로 이동</a>
            </div>
            <div class="check_wrap">
                <div class="form_wrap">
                    <h4>예약자 정보</h4>
                    <form action="" id="hotelForm">
                        <fieldset>
                            <div class="name_wrap_kr">
                                <div class="n_wk_name inputBox">
                                    <label for="hotelForm_name">이름(한글)<strong>*</strong></label>
                                    <input type="text" name="name_kr" id="hotelForm_name">
                                </div>
                            </div>
                            <div class="name_wrap_en">
                                <div class="n_we_fn inputBox">
                                    <label for="hotelForm_family_name">성(영문)<strong>*</strong></label>
                                    <input type="text" name="family_name_en" id="hotelform_family_name">
                                </div>
                                <div class="n_we_ln inputBox">
                                    <label for="hotelform_last_name">이름(영문)<strong>*</strong></label>
                                    <input type="text" name="last_name_en" id="hotelForm_last_name">
                                </div>
                            </div>
                            <div class="convert_check">
                                <input type="checkbox" name="" id="hotelForm_name_for_eng">
                                <label for="hotelForm_name_for_eng">영문으로 입력</label>
                            </div>
                        </fieldset>
                        <fieldset>
                            <div class="phone_wrap inputBox">
                                <label for="hotelForm_phone">전화번호<strong>*</strong></label>
                                <input type="tel" name="phone" id="hotelForm_phone" maxlength="11" placeholder="'-' 없이 입력">
                            </div>
                            <div class="email_wrap inputBox">
                                <label for="hotelForm_email">이메일<strong>*</strong></label>
                                <input type="email" name="email" id="hotelForm_email">
                            </div>
                        </fieldset>
                        
                        <fieldset>
                            <div class="arrive_wrap inputBox">
                                <label for="hotelForm_arrive_time">도착 예정 시간을 알려주세요.</label>
                                <input type="text" name="arrive_time" id="hotelForm_arrive_time" placeholder="선택 시 클릭" readonly>
                                <ul class="arrive_option">
                                    <li><a href="#none">04:00 PM (16:00) ~ </a></li>
                                    <li><a href="#none">05:00 PM (17:00) ~ </a></li>
                                    <li><a href="#none">06:00 PM (18:00) ~ </a></li>
                                    <li><a href="#none">07:00 PM (19:00) ~ </a></li>
                                    <li><a href="#none">08:00 PM (20:00) ~ </a></li>
                                    <li><a href="#none">09:00 PM (21:00) ~ </a></li>
                                    <li><a href="#none">10:00 PM (22:00) ~ </a></li>
                                    <li><a href="#none">11:00 PM (23:00) ~ </a></li>
                                </ul>
                            </div>
                            <div class="arrive_wrap inputBox">
                                <label for="hotelForm_annual_pass">연간회원권 번호 <span>( *소지 시 선택사항)</span></label>
                                <input type="text" name="annual_pass" id="hotelForm_annual_pass">
                            </div>
                        </fieldset>
                        <fieldset>
                            <div class="request_wrap inputBox">
                                <label for="hotelform_request">추가 요청사항</label>
                                <textarea name="request" id="hotelForm_request" placeholder="ex. 추가 물품이 필요합니다."></textarea>
                            </div>
                            <input type="hidden" name="total_price" id="hotelForm_total_price">
                        </fieldset>
                    </form>
                    <div class="terms">
                        <div class="terms_check">
                            <input type="checkbox" name="" id="terms_check_input">
                            <label for="terms_check_input"><em>이용 약관&nbsp;</em>을 확인했으며, 이에 동의합니다.</label>
                        </div>
                        <div class="terms_text">
                            <strong>이용 약관</strong><br/><br/>
                            <br/>이용 약관 및 개인 정보 보호 정책
                            <br/>
                            <br/>1. 객실요금은 1박당 성인 2명, 소인 1명이 기준이며, 객실요금의 10%가 세금으로 별도 부과됩니다.
                            <br/>
                            <br/>&nbsp;&nbsp;대인 : 만 13세이상
                            <br/>
                            <br/>&nbsp;&nbsp;소인 : 만 2세 이상 (투숙일 기준 24개월 이상) ~ 만 12세
                            <br/>
                            <br/>&nbsp;&nbsp;유아 : 만 2세 미만 (투숙일 기준 23개월 이하)
                            <br/>
                            <br/>2.객실 종류에 따라 최대 입실 정원이 상이합니다. 객실 별 입실 정원은 아래와 같습니다.
                            <br/>
                            <br/>&nbsp;&nbsp;프리미엄: 성인 2 + 소인 3
                            <br/>
                            <br/>&nbsp;&nbsp;프리미엄 코너 : 성인 3 + 소인 3
                            <br/>
                            <br/>&nbsp;&nbsp;스위트: 성인 3 + 소인 3
                            <br/>
                            <br/>&nbsp;&nbsp;디럭스 스위트: 성인 3 + 소인 3
                            <br/>
                            <br/>3. 일반적인 예약취소 규정은 다음과 같습니다.
                            <br/>
                            <br/>&nbsp;&nbsp;입실 3일 전 오후 4시까지 취소하는 경우는 결제하신 수단으로 환불됩니다.
                            <br/>&nbsp;&nbsp;단, 예약하신 상품에 따라 취소 규정이 상이할 수 있으니 각 패키지별 규정을 참고하시기 바랍니다.
                            <br/>
                            <br/>4. 노쇼 규정
                            <br/>
                            <br/>&nbsp;&nbsp;예약 사항에 명시되어 있는 입실 날짜에 입실하지 않을 경우 전체 투숙일의 100% 요금이 부과됩니다. 프로모션에 따라 취소, 환불이 불가 할 수 있으며, 이 경우 해당 프로모션의 이용 규정이 적용됩니다.
                            <br/>
                            <br/>5. 객실 요금은 예약이 확정되는 시점에 따라 변동되며, 확정된 예약을 변경할 경우에도 변경 시점에 안내 받는 요금으로 적용됩니다.
                            <br/>
                            <br/>6. 모든 요금 결제가 완료되어야 예약이 확정됩니다.
                            <br/>
                            <br/>7. LEGOLAND® 호텔은 Cashless로 운영되고 있습니다. 모든 지불은 카드로만 가능합니다.
                            <br/>
                            <br/>8. 투숙 기간 동안 객실로 룸 차지를 원하시는 경우 1박당 10만원의 보증금을 예치하여야 하며, 프런트데스크에 방문하여 체크인을 진행하여 주십시오.
                            <br/>
                            <br/>&nbsp;&nbsp;예치된 금액은 체크아웃 시 추가 지불 내역을 확인하여 실 결제 이후 취소됩니다.
                            <br/>
                            <br/>9. 규정된 입실 시간은 오후 4시 이후이며, 퇴실시간은 오전 11시입니다. 얼리체크인과 레이트 체크아웃은 리조트 당일 이용 가능 여부에 따라 달라집니다.
                            <br/>
                            <br/>10. 전열기구, 조리기구 등 화재의 위험이 있는 물품은 객실 반입이 불가합니다.
                            <br/>
                            <br/>11. 분실물 규정
                            <br/>
                            <br/>&nbsp;&nbsp; - 개인 물품이나 귀중품에 대한 책임은 호텔에 있지 않으며, 분실 또는 훼손에 대해 호텔에서 책임을 지지 않습니다.
                            <br/>&nbsp;&nbsp; - 습득물은 원소유주의 반환 요청이 접수될 경우 호텔은 해당 분실 물품을 찾으실 수 있도록 최대한 도움을 드립니다.
                            <br/>&nbsp;&nbsp; - 분실물에 대한 문의 시 분실물 추적과 확인의 목적으로 호텔 시스템 내 기록된 투숙객 이름, 투숙 날짜, 객실 번호, 분실물 상세 내용 등의 특정 정보를 제공해야 합니다.
                            <br/>&nbsp;&nbsp; - 음식물의 경우 발견 즉시 폐기되며, 호텔의 분실물 규정에 적용되지 않습니다. 이 외 지정된 보관 기간을 준수하며 이후 처리 절차에 따라 폐기 또는 이관 합니다.
                            <br/>&nbsp;&nbsp; - 분실물 규정내 보관 가능 물품은 15일 기준 보관하며, 보관 기간이 경과한 물품에 대해 원소유주의 반환 요청이 없는 경우 자체 폐기 또는 경찰서 인계 합니다.
                            <br/>&nbsp;&nbsp; - 현장 수령을 제외한 모든 분실물은 착불 택배로 반환요청이 가능합니다. 배송 중 물품 분실 및 훼손에 대하여 호텔에서 책임을 지지 않습니다.
                            <br/>
                            <br/>12. 호텔은 현지 법률에 의거하여, 고객의 사기, 부적절한 행동 또는 오류에 의한 예약으로 판단되는 경우 예약에 대한 취소 또는 변경 권한을 갖습니다.
                            <br/>
                            <br/>13. 분쟁이 발생할 경우 호텔은 최종 의사 결정에 대한 권한을 갖습니다.
                            <br/>
                            <br/>14. 본 규정은 일반 예약에 한하여 적용되며, 10객실 이상의 단체 예약의 경우 호텔 예약실로 문의바랍니다.
                            <br/>
                            <br/>15. 특별 규정
                            <br/>
                            <br/>&nbsp;&nbsp; - LEGOLAND® 호텔에서는 반려동물 입장은 허용되지 않으나, 안내견은 입장이 가능합니다.
                            <br/>&nbsp;&nbsp; - 청소년 기본법에 따라 단독 숙박이 가능한 나이는 만 19세부터입니다. 미성년자의 단독 투숙 및 입실이 불가하며, 반드시 부모 또는 법적 보호자 동반이 필요합니다.
                            <br/>&nbsp;&nbsp; - LEGOLAND® 호텔 내 전시 되어있는 레고 모델 파손 시 비용이 발생될 수 있습니다.
                            <br/>
                            <br/>
                            <br/>불가항력조항
                            <br/>
                            <br/>LEGOLAND® 호텔은 불가항력에 기인한 계약의 불이행 또는 지연에 대해 면책됩니다. 폭풍우, 낙뢰, 지진, 태풍, 홍수 등과 같은 자연적인 불가항력 외에 기계 고장, 동맹파업, 공장폐쇄, 원자재 부족, 화재, 선박의 징발, 운송 기관의 우발사고나 내란, 전쟁, 정부의 간섭 등에 따른 비상 위험 등에 기인한 지연이나 계약 불이행 또한 불가항력 조항에 의해 면책됩니다.
                            <br/>
                            <br/>취소 정책
                            <br/>
                            <br/>&nbsp;&nbsp;예약일로부터 3일 이전까지 무료로 취소 가능합니다.
                        </div>
                    </div>
                </div>
                <div class="check">
                    <h4>예약 목록</h4>
                    <ul>
                    </ul>
                    <div class="total_wrap">
                        <div class="check_total">
                            <strong>총 요금</strong>
                            <span></span>
                        </div>
                    </div>
                    <div class="check_button">
                        <button type="submit" form="hotelForm"><strong>예약하기</strong></button>
                    </div>
                </div>
            </div>
            
        </div>
    </main>
    <footer></footer>
    <script>
        $(function(){
            //load==================================
            function colors(i) {
                const arr = ["red", "blue", "green", "yellow", "pink"]
                $(".loading_block").eq(i).css("background-color", arr[i]);
            }
            $(".loading_block").each(function(i){
                const set = setTimeout(function(){
                    colors(i);
                }, 500*i)
            })
            $(window).on("load",function(){
                $(".mainWrap").show();
                $(".loadingWrap").remove();
            })
            $("header").load("/header/header.html")
            $("footer").load("/footer/footer.html")
       
            // 가격 숫자 //
            function comma(x) {
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }      
            // ========================================================= //
            $("#hotelForm_name_for_eng").on("change",function(){
                if ($(this).is(":checked")) {
                    $(".name_wrap_kr").hide();
                    $(".name_wrap_en").css("display","flex");
                } else {
                    $(".name_wrap_kr").show();
                    $(".name_wrap_en").css("display","none");
                }
            });
            $("#hotelForm_arrive_time")
                .on("click",function(){$(".arrive_option").slideToggle();})
            $(".arrive_option").on("click","a",function(){
                const t = $(this).text();
                $("#hotelForm_arrive_time").val((i,v) => t);
                $(".arrive_option").slideUp();
            })
            
            // 예약 목록 생성 //
            let total=0;
            function listUp() {
                $(".check > ul").children().remove();
                total = 0;
                const data = JSON.parse(localStorage.getItem("hotelBasket"));
                const dataLen = data.length;
                for( let j = 0; j < dataLen; j++) {
                    const len = data[j]["price"].length;
                    for(let i = 0; i < len; i++) {
                        total += +data[j].price[i];
                        const $li = $(`
                            <li class="check_li">
                                <a href='#none' class='check_delete'>목록에서 삭제</a>
                                <div class="check_list">
                                    <div class="check_date">${data[j].checkinText} → ${data[j].checkoutText}</div>
                                    <div class="check_theme">${data[j].theme[i]}</div>
                                    <div class="check_room">${data[j].title[i]}</div>
                                    <div class="check_price">￦ ${comma(data[j].price[i])}</div>
                                </div>
                            </li>
                        `);
                        $(".check ul").append($li);
                        $li.on("click",".check_delete",function(){
                            total -= +data[j].price[i];
                            if (data[j].price.length == 1) {
                                data.splice(j,1);
                            } else {
                                data[j].price.splice(i,1);
                                data[j].theme.splice(i,1);
                                data[j].title.splice(i,1);
                            }
                            $li.remove();
                            localStorage.setItem("hotelBasket", JSON.stringify(data));
                            listUp();
                            if ( $(".check_li").length == 0) {
                                alert("예약 목록이 없습니다. 예약페이지로 이동합니다.");
                                location.href = "/t_hotel/t_hotel_reser01.html"
                            }
                        })
                    }
                }
                $("#hotelForm_total_price").val((i,v) => total);
                $(".check_total span").text(`￦ ${comma(total)}`);
            }
            listUp();
            $("#hotelForm").on("submit",function(event){
                event.preventDefault();
                if( ($("#hotelForm_name").val()||($("#hotelForm_family_name").val()&&$("#hotelForm_last_name").val()))
                   && $("#hotelForm_phone").val() && $("#hotelForm_email").val()) {
                if ( $("#terms_check_input").is(":checked")) {

                
                const q = new FormData(event.target);
                const w = Object.fromEntries(q.entries());
                const time = Date.now();
                w.submitTime = time;

                const basket = JSON.parse(localStorage.getItem("hotelBasket"));
                basket.push(w);
                localStorage.setItem(`hotelReservation.${time}`, JSON.stringify(basket));
                localStorage.removeItem("hotelBasket");

                alert(`${comma(total)}원 결제하세요.`);
                $.post("example.html",{ price : total, codeNumber : time});
                location.href = '/t_use/t_use_char01.html';
                } else {
                    alert("결제를 위해 약관 동의가 필요합니다.")
                }
                   } else {
                    alert("정보를 정확히 입력하여주십시오.")
                   }
            })
        });
    </script>
</body>
</html>